(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c5979c6"],{"20d1":function(t,e,c){"use strict";c.r(e);c("4de4"),c("d3b7");var n=c("7a23"),a={class:"table mt-4"},l=Object(n["g"])("thead",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",null,"購買時間"),Object(n["g"])("th",null,"Email"),Object(n["g"])("th",null,"購買款項"),Object(n["g"])("th",null,"應付金額"),Object(n["g"])("th",null,"是否付款"),Object(n["g"])("th",null,"編輯")])],-1),r=["textContent"],o={class:"list-unstyled"},i={class:"text-right"},d={class:"form-check form-switch"},s=["id","onUpdate:modelValue"],b=["for"],u={key:0},O={key:1},j={class:"btn-group"},g=["onClick","disabled"],p=Object(n["h"])(" 檢視 "),m={class:"spinner-border spinner-border-sm",role:"status"},h=["onClick","disabled"],f=Object(n["h"])(" 刪除 "),v={class:"spinner-border spinner-border-sm",role:"status"};function _(t,e,c,_,y,k){var x=Object(n["x"])("OrderPagination"),w=Object(n["x"])("deleteModal"),z=Object(n["x"])("orderModal"),C=Object(n["x"])("loading");return Object(n["s"])(),Object(n["f"])(n["a"],null,[Object(n["g"])("table",a,[l,Object(n["g"])("tbody",null,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["w"])(y.orders,(function(t,e){return Object(n["s"])(),Object(n["f"])(n["a"],{key:e},[y.orders.length?(Object(n["s"])(),Object(n["f"])("tr",{key:0,class:Object(n["o"])({"text-secondary":!t.is_paid})},[Object(n["g"])("td",null,Object(n["z"])(k.filter(t.create_at)),1),Object(n["g"])("td",null,[t.user?(Object(n["s"])(),Object(n["f"])("span",{key:0,textContent:Object(n["z"])(t.user.email)},null,8,r)):Object(n["e"])("",!0)]),Object(n["g"])("td",null,[Object(n["g"])("ul",o,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["w"])(t.products,(function(t,e){return Object(n["s"])(),Object(n["f"])("li",{key:e},Object(n["z"])(t.product.title)+" 數量："+Object(n["z"])(t.qty)+" "+Object(n["z"])(t.product.unit),1)})),128))])]),Object(n["g"])("td",i,Object(n["z"])(t.total),1),Object(n["g"])("td",null,[Object(n["g"])("div",d,[Object(n["G"])(Object(n["g"])("input",{class:"form-check-input",type:"checkbox",id:"paidSwitch".concat(t.id),"onUpdate:modelValue":function(e){return t.is_paid=e}},null,8,s),[[n["B"],t.is_paid]]),Object(n["g"])("label",{class:"form-check-label",for:"paidSwitch".concat(t.id)},[t.is_paid?(Object(n["s"])(),Object(n["f"])("span",u,"已付款")):(Object(n["s"])(),Object(n["f"])("span",O,"未付款"))],8,b)])]),Object(n["g"])("td",null,[Object(n["g"])("div",j,[Object(n["g"])("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:function(e){return k.view_Order(t)},disabled:t.id===y.loading_item.view},[p,Object(n["G"])(Object(n["g"])("div",m,null,512),[[n["D"],t.id===y.loading_item.view]])],8,g),Object(n["g"])("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:function(e){return k.delete_order(t)},disabled:t.id===y.loading_item.delete},[f,Object(n["G"])(Object(n["g"])("div",v,null,512),[[n["D"],t.id===y.loading_item.delete]])],8,h)])])],2)):Object(n["e"])("",!0)],64)})),128))])]),Object(n["i"])(x,{pagination:y.pagination,onGet_order:k.get_order},null,8,["pagination","onGet_order"]),Object(n["i"])(w),Object(n["i"])(z),Object(n["i"])(C)],64)}c("99af"),c("ac1f"),c("5319");var y=c("c6e3"),k=(c("b0c0"),{class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"}),x={class:"modal-dialog modal-dialog-centered",role:"document"},w={class:"modal-content border-0"},z={class:"modal-header bg-danger text-white"},C={class:"modal-title"},M=Object(n["g"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$={class:"modal-body"},S=Object(n["h"])(" 是否刪除 "),D={class:"text-danger"},G=Object(n["h"])(" (刪除後將無法恢復)。 "),E={class:"modal-footer"},I=Object(n["g"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function L(t,e,c,a,l,r){var o,i,d,s;return Object(n["s"])(),Object(n["f"])("div",k,[Object(n["g"])("div",x,[Object(n["g"])("div",w,[Object(n["g"])("div",z,[Object(n["g"])("h5",C,[Object(n["g"])("span",null,"刪除 ( "+Object(n["z"])(l.order.id)+" ) ",1)]),M]),Object(n["g"])("div",$,[S,Object(n["g"])("strong",D,Object(n["z"])(null===(o=l.order)||void 0===o||null===(i=o.user)||void 0===i?void 0:i.email)+" / "+Object(n["z"])(null===(d=l.order)||void 0===d||null===(s=d.user)||void 0===s?void 0:s.name),1),G]),Object(n["g"])("div",E,[I,Object(n["g"])("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=function(t){return r.delete_order(l.order.id)})}," 確認刪除 ")])])])],512)}var B=c("7c2b"),P=c.n(B),T={data:function(){return{delModal:"",order:[]}},methods:{delete_order:function(t){var e=this,c="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizu123","/admin/order/").concat(t);this.$http.delete(c,{data:this.tempOrder}).then((function(t){alert(t.data.message),e.delModal.hide(),y["a"].emit("get-orders")})).catch((function(t){alert(t.data.message)}))}},mounted:function(){var t=this;this.delModal=new P.a(document.getElementById("delModal")),y["a"].on("deleteOrder",(function(e){t.order=e,t.delModal.show()}))}},H=c("6b0d"),U=c.n(H);const V=U()(T,[["render",L]]);var q=V,A={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},J={class:"modal-dialog modal-xl modal-dialog-centered",role:"document"},F={class:"modal-content border-0"},N=Object(n["g"])("div",{class:"modal-header bg-dark text-white"},[Object(n["g"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(n["g"])("span",null,"訂單細節")]),Object(n["g"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},K={class:"row"},Q={class:"col-md-4"},R=Object(n["g"])("h3",null,"用戶資料",-1),W={class:"table"},Y={key:0},Z=Object(n["g"])("th",{style:{width:"100px"}},"姓名",-1),tt=Object(n["g"])("th",null,"Email",-1),et=Object(n["g"])("th",null,"電話",-1),ct=Object(n["g"])("th",null,"地址",-1),nt={class:"col-md-8"},at=Object(n["g"])("h3",null,"訂單細節",-1),lt={class:"table"},rt=Object(n["g"])("th",{style:{width:"100px"}},"訂單編號",-1),ot=Object(n["g"])("th",null,"下單時間",-1),it=Object(n["g"])("th",null,"付款時間",-1),dt={key:0},st={key:1},bt=Object(n["g"])("th",null,"付款狀態",-1),ut={key:0,class:"text-success"},Ot={key:1,class:"text-muted"},jt=Object(n["g"])("th",null,"總金額",-1),gt=Object(n["g"])("h3",null,"選購商品",-1),pt={class:"table"},mt=Object(n["g"])("thead",null,[Object(n["g"])("tr")],-1),ht={class:"text-end"},ft={class:"d-flex justify-content-end"},vt={class:"form-check"},_t={class:"form-check-label",for:"flexCheckDefault"},yt={key:0},kt={key:1},xt={class:"modal-footer"},wt=Object(n["g"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function zt(t,e,c,a,l,r){return Object(n["s"])(),Object(n["f"])("div",A,[Object(n["g"])("div",J,[Object(n["g"])("div",F,[N,Object(n["g"])("div",X,[Object(n["g"])("div",K,[Object(n["g"])("div",Q,[R,Object(n["g"])("table",W,[l.tempOrder.user?(Object(n["s"])(),Object(n["f"])("tbody",Y,[Object(n["g"])("tr",null,[Z,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.user.name),1)]),Object(n["g"])("tr",null,[tt,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.user.email),1)]),Object(n["g"])("tr",null,[et,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.user.tel),1)]),Object(n["g"])("tr",null,[ct,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.user.address),1)])])):Object(n["e"])("",!0)])]),Object(n["g"])("div",nt,[at,Object(n["g"])("table",lt,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[rt,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.id),1)]),Object(n["g"])("tr",null,[ot,Object(n["g"])("td",null,Object(n["z"])(r.filter(l.tempOrder.create_at)),1)]),Object(n["g"])("tr",null,[it,Object(n["g"])("td",null,[l.tempOrder.paid_date?(Object(n["s"])(),Object(n["f"])("span",dt,Object(n["z"])(r.filter(l.tempOrder.paid_date)),1)):(Object(n["s"])(),Object(n["f"])("span",st,"時間不正確"))])]),Object(n["g"])("tr",null,[bt,Object(n["g"])("td",null,[l.tempOrder.is_paid?(Object(n["s"])(),Object(n["f"])("strong",ut,"已付款")):(Object(n["s"])(),Object(n["f"])("span",Ot,"尚未付款"))])]),Object(n["g"])("tr",null,[jt,Object(n["g"])("td",null,Object(n["z"])(l.tempOrder.total),1)])])]),gt,Object(n["g"])("table",pt,[mt,Object(n["g"])("tbody",null,[(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["w"])(l.tempOrder.products,(function(t){return Object(n["s"])(),Object(n["f"])("tr",{key:t.id},[Object(n["g"])("th",null,Object(n["z"])(t.product.title),1),Object(n["g"])("td",null,Object(n["z"])(t.qty)+" / "+Object(n["z"])(t.product.unit),1),Object(n["g"])("td",ht,Object(n["z"])(t.final_total),1)])})),128))])]),Object(n["g"])("div",ft,[Object(n["g"])("div",vt,[Object(n["G"])(Object(n["g"])("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":e[0]||(e[0]=function(t){return l.tempOrder.is_paid=t})},null,512),[[n["B"],l.tempOrder.is_paid]]),Object(n["g"])("label",_t,[l.tempOrder.is_paid?(Object(n["s"])(),Object(n["f"])("span",yt,"已付款")):(Object(n["s"])(),Object(n["f"])("span",kt,"未付款"))])])])])])]),Object(n["g"])("div",xt,[wt,Object(n["g"])("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=function(t){return r.update_paid_status(l.tempOrder.id)})}," 修改付款狀態 ")])])])],512)}var Ct={data:function(){return{order_modal:"",tempOrder:{create_at:"",id:""}}},methods:{filter:function(t){return new Date(1e3*t).toISOString().substring(0,10)},update_paid_status:function(t){var e=this,c="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizu123","/admin/order/").concat(t);this.$http.put(c,{data:this.tempOrder}).then((function(t){alert(t.data.message),e.order_modal.hide()})).catch((function(t){alert(t.data.message)}))}},mounted:function(){var t=this;this.order_modal=new P.a(document.getElementById("productModal")),y["a"].on("view_order",(function(e){t.tempOrder=e,setTimeout((function(){t.order_modal.show()}),1e3)}))}};const Mt=U()(Ct,[["render",zt]]);var $t=Mt,St={"aria-label":"Page navigation example"},Dt={class:"pagination justify-content-center"},Gt=Object(n["g"])("span",{"aria-hidden":"true"},"«",-1),Et=[Gt],It=["onClick"],Lt=Object(n["g"])("span",{"aria-hidden":"true"},"»",-1),Bt=[Lt];function Pt(t,e,c,a,l,r){return Object(n["s"])(),Object(n["f"])("nav",St,[Object(n["g"])("ul",Dt,[Object(n["g"])("li",{class:Object(n["o"])(["page-item",{disabled:!c.pagination.has_pre}])},[Object(n["g"])("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=Object(n["H"])((function(e){return t.$emit("get_order",c.pagination.current_page-1)}),["prevent"]))},Et)],2),(Object(n["s"])(!0),Object(n["f"])(n["a"],null,Object(n["w"])(c.pagination.total_pages,(function(e){return Object(n["s"])(),Object(n["f"])("li",{class:Object(n["o"])(["page-item",{active:e===c.pagination.current_page}]),key:e},[Object(n["g"])("a",{class:"page-link",href:"#",onClick:Object(n["H"])((function(c){return t.$emit("get_order",e)}),["prevent"])},Object(n["z"])(e),9,It)],2)})),128)),Object(n["g"])("li",{class:Object(n["o"])(["page-item",{disabled:!c.pagination.has_next}])},[Object(n["g"])("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=Object(n["H"])((function(e){return t.$emit("get_order",c.pagination.current_page+1)}),["prevent"]))},Bt)],2)])])}var Tt={props:["pagination"]};const Ht=U()(Tt,[["render",Pt]]);var Ut=Ht,Vt=c("cc89"),qt={components:{loading:Vt["a"],OrderPagination:Ut,orderModal:$t,deleteModal:q},data:function(){return{orders:[],pagination:[],loading_item:{}}},methods:{checkLogin:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io/v2","/api/user/check");this.$http.post(e).catch((function(){t.$router.push("/login")}))},get_order:function(t){var e=this;y["a"].emit("load",500);var c="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizu123","/admin/orders?page=").concat(t);this.$http.get(c).then((function(t){e.pagination=t.data.pagination,e.orders=t.data.orders})).catch((function(){e.$router.push("/login")}))},view_Order:function(t){this.loading("view",t.id),y["a"].emit("view_order",t)},delete_order:function(t){this.loading("delete",t.id),y["a"].emit("deleteOrder",t)},filter:function(t){return new Date(1e3*t).toISOString().substring(0,10)},loading:function(t,e){var c=this;this.loading_item[t]=e,setTimeout((function(){c.loading_item={}}),1e3)}},mounted:function(){var t=this,e=document.cookie.replace(/(?:(?:^|.*;\s*)mizuToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=e,this.get_order(),y["a"].on("get-orders",(function(){t.get_order()})),this.checkLogin()}};const At=U()(qt,[["render",_]]);e["default"]=At},"4de4":function(t,e,c){"use strict";var n=c("23e7"),a=c("b727").filter,l=c("1dde"),r=l("filter");n({target:"Array",proto:!0,forced:!r},{filter:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},b0c0:function(t,e,c){var n=c("83ab"),a=c("5e77").EXISTS,l=c("e330"),r=c("9bf2").f,o=Function.prototype,i=l(o.toString),d=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,s=l(d.exec),b="name";n&&!a&&r(o,b,{configurable:!0,get:function(){try{return s(d,i(this))[1]}catch(t){return""}}})}}]);
//# sourceMappingURL=chunk-6c5979c6.4fa17e89.js.map